# 01.endpoint_list_processes

This action lists the processes currently running on the targeted endpoint. It can be useful when investigating potentially malicious behavior on an endpoint. It was chosen as the first thread because it involves a bit of complexity in targeting since it uses the `process` target but in fact it targets an unknown number of processes and it also needs to target the computer itself.

## OpenC2 translations

### Targeting an endpoint by ipv4

```
{
    "action": "query",
    "target": {
        "openc2:process": {},
        "target_specifier": {
        	"openc2:ipv4_addr": "198.51.100.7"
        }
    }
}
```

Below I will try to explain each line that could be controversial:

#### `"action": "query",`

I considered `scan` but there could be a better scan of a process that actually looks for IoC's or other aspects.

#### `"openc2:process": {},`

I chose to make `openc2:process` the top-level target but I left the object empty (all fields are optional) because I want to see all processes and don't care about filtering on any specific properties. This is sort of like a wildcard. I hope this can evolve smoothly to target specific processes or processes with specific properties by adding to this object.

#### `"target_specifier": { "openc2:ipv4_addr": "198.51.100.7" }`

This is the computer to query. As shown below, it is common for security software to use the IP address to target internal computers so this seems like a natural usage.

## Pretty-printed "list processes" Phantom actions and parameters taken from all_actions_in_phantom.json

As shown below each action actually uses both `app_configuration` and `action_parameters`. Apps in Phantom are like actuators in OpenC2, and the `app_configuration` is supplied once when initially setting up Phantom to talk to an instance of the actuator, usually providing the configuration needed to communicate with that instance such as hostname and api key. Then when actions are called the `action_parameters` are supplied. When translating to OpenC2 most things in `action_parameters` should probably be in the command while `app_configuration` would need to be stored elsewhere by the producer.

```
{u'action_description': u'List the running processes on a machine',
 u'action_name': u'list processes',
 u'action_parameters': {u'ip_hostname': {u'contains': [u'ip', u'host name'],
                                         u'data_type': u'string',
                                         u'description': u'Hostname/IP to list process on',
                                         u'order': 0,
                                         u'required': True}},
 u'app_configuration': {u'device': {u'data_type': u'string',
                                    u'description': u'Device IP/Hostname',
                                    u'order': 0,
                                    u'required': True},
                        u'password': {u'data_type': u'password',
                                      u'description': u'Password',
                                      u'optional': True,
                                      u'order': 5},
                        u'ph': {u'data_type': u'ph', u'order': 3},
                        u'port': {u'data_type': u'string',
                                  u'default': u'443',
                                  u'description': u'Port',
                                  u'order': 1,
                                  u'required': False},
                        u'username': {u'data_type': u'string',
                                      u'description': u'Username',
                                      u'optional': True,
                                      u'order': 4},
                        u'verify_server_cert': {u'data_type': u'boolean',
                                                u'default': False,
                                                u'description': u'Verify server certificate',
                                                u'order': 2,
                                                u'required': True}},
 u'app_description': u'This app supports <b>investigative</b> and <b>containment</b> actions on Tanium.',
 u'app_name': u'Tanium',
 u'app_type': u'endpoint'}
{u'action_description': u'List the running processes on a machine',
 u'action_name': u'list processes',
 u'action_parameters': {u'ip_hostname': {u'contains': [u'ip', u'host name'],
                                         u'data_type': u'string',
                                         u'description': u'Name/IP of the machine to list processes on',
                                         u'order': 0,
                                         u'primary': True,
                                         u'required': False},
                        u'sensor_id': {u'contains': [u'carbon black sensor id'],
                                       u'data_type': u'numeric',
                                       u'description': u'Carbon Black sensor id',
                                       u'order': 1,
                                       u'primary': True,
                                       u'required': False}},
 u'app_configuration': {u'api_token': {u'data_type': u'string',
                                       u'description': u'API Token',
                                       u'order': 2,
                                       u'required': True},
                        u'device_url': {u'data_type': u'string',
                                        u'description': u'Device URL, e.g. https://mycb.enterprise.com',
                                        u'order': 0,
                                        u'required': True},
                        u'verify_server_cert': {u'data_type': u'boolean',
                                                u'default': False,
                                                u'description': u'Verify server certificate',
                                                u'order': 1,
                                                u'required': True}},
 u'app_description': u'This app supports executing various endpoint-based <b>investigative</b> and <b>containment</b> actions on <b>Carbon Black Response</b>',
 u'app_name': u'Carbon Black Response',
 u'app_type': u'endpoint'}
{u'action_description': u'List processes on endpoint.',
 u'action_name': u'list processes',
 u'action_parameters': {u'ip_hostname': {u'contains': [u'ip', u'host name'],
                                         u'data_type': u'string',
                                         u'description': u'Hostname/IP of endpoint',
                                         u'order': 0,
                                         u'primary': True,
                                         u'required': True}},
 u'app_configuration': {u'password': {u'data_type': u'password',
                                      u'description': u'Password',
                                      u'order': 2,
                                      u'required': False},
                        u'root': {u'data_type': u'boolean',
                                  u'default': False,
                                  u'description': u'User is root',
                                  u'order': 1,
                                  u'required': False},
                        u'rsa_key_file': {u'data_type': u'string',
                                          u'description': u'RSA Key file',
                                          u'order': 3,
                                          u'required': False},
                        u'test_device': {u'data_type': u'string',
                                         u'description': u'Device IP/Hostname (for TEST CONNECTIVITY only)',
                                         u'order': 4,
                                         u'required': False},
                        u'username': {u'data_type': u'string',
                                      u'description': u'Username',
                                      u'order': 0,
                                      u'required': True}},
 u'app_description': u'This app supports executing various endpoint-based investigative and containment actions like <b>list processes</b>, <b>terminate process</b>, <b>reboot system</b>, <b>execute program</b>,  etc. on an SSH endpoint.',
 u'app_name': u'SSH',
 u'app_type': u'endpoint'}
{u'action_description': u'List processes that have recently used the IOC on a particular device.',
 u'action_name': u'list processes',
 u'action_parameters': {u'id': {u'contains': [u'falcon device id'],
                                u'data_type': u'string',
                                u'description': u'Falcon Device ID to search on',
                                u'primary': True,
                                u'required': True},
                        u'ioc': {u'contains': [u'hash',
                                               u'sha256',
                                               u'sha1',
                                               u'md5',
                                               u'domain'],
                                 u'data_type': u'string',
                                 u'description': u'File Hash or Domain to use for searching',
                                 u'primary': True,
                                 u'required': True}},
 u'app_configuration': {u'baseurl': {u'data_type': u'string',
                                     u'default': u'https://falconapi.crowdstrike.com/',
                                     u'description': u'API Base URL',
                                     u'order': 0,
                                     u'required': True},
                        u'key': {u'data_type': u'password',
                                 u'description': u'Falcon API Key',
                                 u'order': 3,
                                 u'required': True},
                        u'user': {u'data_type': u'string',
                                  u'description': u'Falcon API User',
                                  u'order': 2,
                                  u'required': True},
                        u'verify_server_cert': {u'data_type': u'boolean',
                                                u'default': False,
                                                u'description': u'Verify server certificate',
                                                u'order': 1,
                                                u'required': True}},
 u'app_description': u'This app allows you to manage indicators of compromise (IOC) and <b>investigate</b> your endpoints on the Falcon Host API',
 u'app_name': u'Falcon Host API',
 u'app_type': u'endpoint'}
{u'action_description': u'List the running processes on a machine',
 u'action_name': u'list processes',
 u'action_parameters': {u'ip_hostname': {u'contains': [u'ip', u'host name'],
                                         u'data_type': u'string',
                                         u'default': u'',
                                         u'description': u'Hostname/IP of the machine to list processes on',
                                         u'order': 0,
                                         u'primary': True,
                                         u'required': False,
                                         u'value_list': []}},
 u'app_configuration': {u'access_token': {u'data_type': u'password',
                                          u'description': u'REST API Access Token',
                                          u'order': 1,
                                          u'required': True},
                        u'sentinelone_server_url': {u'data_type': u'string',
                                                    u'description': u'SentinelOne Server URL',
                                                    u'order': 0,
                                                    u'required': True}},
 u'app_description': u'This app integrates with the SentinelOne platform to implement investigative and containment actions on endpoints',
 u'app_name': u'SentinelOne',
 u'app_type': u'endpoint'}
{u'action_description': u'List all processes on a given server',
 u'action_name': u'list processes',
 u'action_parameters': {u'aws_instance_id': {u'contains': [u'cloudpassagehalo aws instance id'],
                                             u'data_type': u'string',
                                             u'description': u'AWS instance ID',
                                             u'order': 0,
                                             u'primary': True},
                        u'hostname': {u'contains': [u'host name'],
                                      u'data_type': u'string',
                                      u'description': u'Hostname',
                                      u'order': 2,
                                      u'primary': True},
                        u'ip': {u'contains': [u'ip'],
                                u'data_type': u'string',
                                u'description': u'IP',
                                u'order': 1,
                                u'primary': True}},
 u'app_configuration': {u'client_id': {u'data_type': u'string',
                                       u'description': u'Client ID',
                                       u'order': 1,
                                       u'required': True},
                        u'client_secret': {u'data_type': u'password',
                                           u'description': u'Client secret',
                                           u'order': 2,
                                           u'required': True},
                        u'url': {u'data_type': u'string',
                                 u'description': u'URL (eg: https://api.cloudpassage.com)',
                                 u'order': 0,
                                 u'required': True}},
 u'app_description': u'This app supports a variety of investigative actions on CloudPassage Halo',
 u'app_name': u'CloudPassage Halo',
 u'app_type': u'investigative'}
{u'action_description': u'Queries the system memory dump file for a list of processes and their information',
 u'action_name': u'list processes',
 u'action_parameters': {u'profile': {u'contains': [u'volatility profile'],
                                     u'data_type': u'string',
                                     u'description': u'Volatility profile of the memory dump file',
                                     u'order': 1},
                        u'vault_id': {u'contains': [u'vault id',
                                                    u'os memory dump'],
                                      u'data_type': u'string',
                                      u'description': u'Phantom Vault ID of the dump file',
                                      u'order': 0,
                                      u'primary': True,
                                      u'required': True}},
 u'app_configuration': {},
 u'app_description': u'This app implements a variety of <b>investigative</b> actions on the <b>Volatility forensics analysis platform</b>.',
 u'app_name': u'Volatility',
 u'app_type': u'forensic'}
```
